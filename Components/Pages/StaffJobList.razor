@inject ApplicationDbContext DbContext;

@page "/staff-job-list";
@using GymSync.Data;
@using GymSync.Models;
@using GymSync.Views;
@using GymSync.Components;
@using Microsoft.EntityFrameworkCore;

<PageTitle>GymSync Staff Job Listing</PageTitle>

<h3>StaffJobList</h3>

<p>This page displays the gym's staff and their current role in the facility</p>

@if (!_ready)
{
	<p><em>Loading...</em></p>
}
else
{
	@foreach (var user in _StaffJobsList)
	{
		<p>@user.FirstName @user.LastName</p>	
	}
}

@code {

	//set the required variables for each time the page is loaded.
	private Query _query;
	private bool _ready;

	//List of StaffJobView classes for page info
	private List<StaffJobView> _StaffJobsList;

	//local data transfer class for working with IQuesyable
	public class StaffDto { public int staff_id { get; set; } public int user_id { get; set; } }

	//Code for loading the page
	protected override async Task OnInitializedAsync()
	{
		_ready = false;

		_query = new Query(DbContext);

		//get the list of members from the user_x_staff list.
		foreach (var staff in await DbContext.USER_x_STAFF.Select(t => new StaffDto { staff_id = t.staff_id, user_id = t.user_id }).ToListAsync())
		{
			//need to check if user exists in the staff_x_job table
		}

		_ready = true;
	}



}
